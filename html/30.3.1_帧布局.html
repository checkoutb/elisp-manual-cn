<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="elisp.css"><title>30.3.1 帧布局</title></head><body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000"><h3 class="subsection">30.3.1 帧布局</h3>
<div class="nav-panel"><p>Next: <a href="30.3.2_帧字体.html">帧字体</a>, Previous: <a href="30.3_帧几何.html">帧几何</a>, Up: <a href="30.3_帧几何.html">帧几何.</a> &nbsp; [<a href="00_content.htm" title="Table of contents" rel="contents">Contents</a>]</p></div></body></html><hr/><p>可见帧在其终端显示器上占据一个矩形区域。该区域可能包含许多嵌套的矩形，每个矩形都有不同的用途。下图描绘了图形终端上帧的布局：
</p>
<div class="lisp">
<pre class="lisp">        &lt;------------ Outer Frame Width -----------&gt;
        ____________________________________________
     ^(0)  ________ External/Outer Border _______   |
     | |  |_____________ Title Bar ______________|  |
     | | (1)_____________ Menu Bar ______________|  | ^
     | | (2)_____________ Tool Bar ______________|  | ^
     | | (3)_____________ Tab Bar _______________|  | ^
     | |  |  _________ Internal Border ________  |  | ^
     | |  | |   ^                              | |  | |
     | |  | |   |                              | |  | |
Outer  |  | | Inner                            | |  | Native
Frame  |  | | Frame                            | |  | Frame
Height |  | | Height                           | |  | Height
     | |  | |   |                              | |  | |
     | |  | |&lt;--+--- Inner Frame Width -------&gt;| |  | |
     | |  | |   |                              | |  | |
     | |  | |___v______________________________| |  | |
     | |  |___________ Internal Border __________|  | v
     v |___________ External/Outer Border __________|
           &lt;-------- Native Frame Width --------&gt;
</pre></div>
<p>实际上，并非图中所示的所有区域都将或可能存在。这些区域的含义如下所述。
</p>
<p>外框¶
</p>
<p>外框是一个矩形，包括图中所示的所有区域。该矩形的边缘称为帧的外边缘。帧的外部宽度和外部高度一起指定了该矩形的外部大小。
</p>
<p>了解帧的外部尺寸对于将帧装入其显示器的工作区域（请参阅多个终端）或将两个帧彼此相邻放置在屏幕上很有用。通常，帧的外部尺寸只有在帧至少被映射一次后才可用（使其可见，请参阅帧的可见性）。对于初始帧或尚未创建的帧，外部大小只能估计或必须根据窗口系统或窗口管理器的默认值计算。一种解决方法是获取映射帧的外部和本机（见下文）大小的差异，并使用它们来计算新帧的外部大小。
</p>
<p>外框左上角的位置（上图中用’(0)’表示）就是外框的位置。图形帧的外部位置也称为帧的 <code>位置</code> ，因为无论何时调整帧大小或更改其布局，它通常在其显示上保持不变。
</p>
<p>    外部位置由左侧和顶部帧参数指定并可通过其设置（请参阅位置参数）。对于普通的顶级帧，这些参数通常表示其相对于其显示原点的绝对位置（见下文）。对于子帧（请参阅子帧），这些参数表示其相对于其父帧的原始位置（见下文）的位置。对于文本终端上的帧，这些参数的值是无意义的并且始终为零。
外部边框¶
</p>
<p>外部边框是窗口管理器提供的装饰的一部分。它通常用于使用鼠标调整帧的大小，因此不会在 <code>fullboth</code> 和最大化的帧上显示（请参阅大小参数）。它的宽度由窗口管理器决定，不能被 Emacs 的函数改变。
</p>
<p>    文本终端帧上不存在外部边框。对于图形帧，可以通过设置 override-redirect 或 undecorated frame 参数来抑制它们的显示（请参阅窗口管理参数）。
外边界¶
</p>
<p>外边框是一个单独的边框，其宽度可以使用border-width frame 参数指定（请参阅布局参数）。在实践中，帧的外部或外部边界都会显示，但不会同时显示。通常，外边框仅显示为不（完全）由窗口管理器控制的特殊帧，如工具提示帧（参见工具提示）、子帧（参见子帧）和未装饰或覆盖重定向帧（参见窗口管理参数） .
</p>
<p>    外部边框永远不会显示在文本终端帧和由 GTK+ 例程生成的帧上。在 MS-Windows 上，外部边框是在一个像素宽的外部边框的帮助下模拟的。基于 X 的非工具包构建允许通过设置边框颜色帧参数来更改外边框的颜色（请参阅布局参数）。
标题栏 ¶
</p>
<p>    标题栏，又称标题栏，也是窗口管理器装饰的一部分，通常显示帧的标题（请参阅帧标题）以及用于最小化、最大化和删除帧的按钮。它也可以用于用鼠标拖动帧。标题栏通常不会为 fullboth（请参阅大小参数）、工具提示（请参阅工具提示）和子帧（请参阅子帧）显示，并且对于终端帧也不存在。可以通过设置覆盖重定向或未修饰的帧参数来抑制标题栏的显示（请参阅窗口管理参数）。
菜单栏 ¶
</p>
<p>菜单栏（请参阅菜单栏）可以是内部的（由 Emacs 自己绘制）或外部的（由工具包绘制）。大多数构建（GTK+、Lucid、Motif 和 MS-Windows）依赖于外部菜单栏。NS 也使用一个外部菜单栏，但是，它不是外部帧的一部分。非工具包构建可以提供内部菜单栏。在文本终端帧上，菜单栏是帧根窗口的一部分（请参阅 Windows 和帧）。通常，菜单栏永远不会显示在子帧上（请参阅子帧）。可以通过将 menu-bar-lines 参数（请参阅布局参数）设置为零来抑制菜单栏的显示。
</p>
<p>    每当菜单栏的宽度变得太大而无法容纳在其帧上时，菜单栏是被包裹还是被截断取决于工具包。通常，只有 Motif 和 MS-Windows 版本可以包装菜单栏。当他们（展开）菜单栏时，他们试图保持帧的外部高度不变，因此帧的本机高度（见下文）将会改变。
工具栏¶
</p>
<p>与菜单栏一样，工具栏（请参阅工具栏）可以是内部的（由 Emacs 本身绘制）或外部的（由工具包绘制）。GTK+ 和 NS 构建具有由工具包绘制的工具栏。其余构建使用内部工具栏。使用 GTK+，工具栏可以位于帧的任一侧，紧靠内部边界之外，见下文。子帧通常不显示工具栏（请参阅子帧）。可以通过将 tool-bar-lines 参数（请参阅布局参数）设置为零来抑制工具栏的显示。
</p>
<p>    如果变量 auto-resize-tool-bars 不为 nil，Emacs 会在内部工具栏的宽度变得对其帧来说太大时包装内部工具栏。如果当 Emacs (un-) 包裹内部工具栏时，它默认保持帧的外部高度不变，因此帧的原生高度（见下文）将会改变。另一方面，使用 GTK+ 构建的 Emacs 从不包裹工具栏，但可能会自动增加帧的外部宽度以适应过长的工具栏。
标签栏¶
</p>
<p>    标签栏（参见 GNU Emacs 手册中的标签栏）总是由 Emacs 自己绘制。标签栏出现在使用内部工具栏构建的 Emacs 工具栏上方，而在使用外部工具栏构建的 Emacs 工具栏下方。可以通过将 tab-bar-lines 参数（请参阅布局参数）设置为零来抑制标签栏的显示。
原生帧¶
</p>
<p>本机帧是完全位于外帧内的矩形。它不包括由外部或外部边框、标题栏和任何外部菜单或工具栏占据的区域。本机帧的边缘称为帧的本机边缘。帧的原生宽度和原生高度一起指定了帧的原生大小。
</p>
<p>帧的原生大小是 Emacs 在 Emacs 中创建或调整帧大小时传递给窗口系统或窗口管理器的大小。它也是 Emacs 在调整帧的窗口系统窗口大小时从窗口系统或窗口管理器接收到的大小，例如，在通过单击标题栏中的相应按钮来最大化帧之后，或者在使用老鼠。
</p>
<p>原生帧左上角的位置指定了帧的原生位置。上图中的 (1)–(3) 表示各种构建的位置：
</p>
<p>(1) 非工具包和终端帧
(2) Lucid、Motif 和 MS-Windows 帧
(3) GTK+ 和 NS 帧
</p>
<p>因此，帧的原始高度可能包括工具栏的高度，但不包括菜单栏的高度（Lucid、Motif、MS-Windows）或菜单栏和工具栏的高度（非工具包和文本终端帧） ）。
</p>
<p>帧的原始位置是设置或返回鼠标当前位置的函数（请参阅鼠标位置）和处理窗口位置的函数（如窗口边缘、窗口位置或窗口坐标）的参考位置-p（参见坐标和窗口）。它还指定了 (0, 0) 原点，用于在此帧内定位和定位子帧（请参阅子帧）。
</p>
<p>    另请注意，通过更改帧的覆盖重定向或未装饰参数（请参阅窗口管理参数）来删除或添加窗口管理器装饰时，帧的本机位置通常在其显示上保持不变。
内部边框
</p>
<p>内部边框是 Emacs 围绕内部帧绘制的边框（见下文）。其外观规范取决于给定帧是否为子帧（请参阅子帧）。
</p>
<p>对于普通帧，其宽度由 internal-border-width 帧参数指定（请参阅布局参数），其颜色由内部边框面的背景指定。
</p>
<p>    对于子帧，其宽度由 child-frame-border-width 帧参数指定（但将使用 internal-border-width 参数作为后备），其颜色由 child-frame-border 面的背景指定。
内框¶
</p>
<p>内部帧是为帧窗口保留的矩形。它被内部边框包围，但是，它不是内部帧的一部分。它的边缘称为帧的内边缘。内部宽度和内部高度指定矩形的内部大小。内框有时也称为框的显示区域。
</p>
<p>    通常，内部帧被细分为帧的根窗口（参见 Windows 和帧）和帧的 minibuffer 窗口（参见 Minibuffer Windows）。此规则有两个值得注意的例外： 无 minibuffer 帧仅包含根窗口，不包含 minibuffer 窗口。minibuffer-only 帧仅包含一个 minibuffer 窗口，该窗口也用作该帧的根窗口。有关如何创建此类帧配置的信息，请参阅初始帧参数。
文本区¶
</p>
<p>帧的文本区域是一个有点虚构的区域，可以嵌入到本机帧中。它的位置是未指定的。它的宽度可以通过从本机宽度的宽度中去除内部边框、一个垂直滚动条和一个左右边缘的宽度（如果为此帧指定），请参阅布局参数。它的高度可以通过从本机高度中删除内部边框的宽度以及帧的内部菜单和工具栏、标签栏和一个水平滚动条的高度（如果为此帧指定）来获得。
</p>
<p>帧的绝对位置以相对于帧显示的原点 (0, 0) 的水平和垂直像素偏移对 (X, Y) 的形式给出。相应地，帧的绝对边缘作为从该原点的像素偏移量给出。
</p>
<p>请注意，对于多台显示器，显示的原点不一定与终端的整个可用显示区域的左上角重合。因此，在这样的环境中，即使该帧完全可见，帧的绝对位置也可能为负值。
</p>
<p>按照惯例，垂直偏移 <code>向下</code> 增加。这意味着帧的高度是通过从其底部边缘的偏移量中减去其顶部边缘的偏移量来获得的。正如预期的那样，水平偏移量 <code>向右</code> 增加，因此帧的宽度是通过从其右边缘的偏移量中减去其左边缘的偏移量来计算的。
</p>
<p>对于图形终端上的帧，以下函数返回上述区域的大小：
</p>
<div class="lisp">
<pre class="lisp">Function: frame-geometry &amp;optional frame ¶
</pre></div>
<p>该函数返回帧的几何属性。返回值是下面列出的属性的关联列表。所有坐标、高度和宽度值都是整数，计数像素。请注意，如果尚未映射帧，（请参阅帧的可见性）某些返回值可能仅表示实际值的近似值 - 那些在帧映射后可以看到的值。
</p>
<div class="lisp">
<pre class="lisp">outer-position
</pre></div>
<p>一个 cons 表示外部帧的绝对位置，相对于帧显示位置 (0, 0) 的原点。
</p><div class="lisp">
<pre class="lisp">outer-size
</pre></div>
<p>帧的外部宽度和高度的缺点。
</p><div class="lisp">
<pre class="lisp">external-border-size
</pre></div>
<p>窗口管理器提供的帧外部边框的水平和垂直宽度的缺点。如果窗口管理器不提供这些值，Emacs 将尝试从外框和内框的坐标中猜测它们。
</p><div class="lisp">
<pre class="lisp">outer-border-width
</pre></div>
<p>帧外边框的宽度。该值仅对非 GTK+ X 构建有意义。
</p><div class="lisp">
<pre class="lisp">title-bar-size
</pre></div>
<p>窗口管理器或操作系统提供的帧标题栏的宽度和高度的缺点。如果它们都为零，则帧没有标题栏。如果仅宽度为零，则 Emacs 无法检索宽度信息。
</p><div class="lisp">
<pre class="lisp">menu-bar-external
</pre></div>
<p>如果非零，这意味着菜单栏是外部的（不是帧的本机帧的一部分）。
</p><div class="lisp">
<pre class="lisp">menu-bar-size
</pre></div>
<p>帧菜单栏的宽度和高度的缺点。
</p><div class="lisp">
<pre class="lisp">tool-bar-external
</pre></div>
<p>如果非零，这意味着工具栏是外部的（不是帧的本机帧的一部分）。
</p><div class="lisp">
<pre class="lisp">tool-bar-position
</pre></div>
<p>这告诉帧上的工具栏在哪一侧，并且可以是左侧、顶部、右侧或底部之一。目前唯一支持除 top 之外的值的工具包是 GTK+。
</p><div class="lisp">
<pre class="lisp">tool-bar-size
</pre></div>
<p>帧工具栏的宽度和高度的一个缺点。
</p><div class="lisp">
<pre class="lisp">internal-border-width
</pre></div>
<p>帧内部边框的宽度。
</p>
<p>以下函数可用于检索外框、原生框和内框的边缘。
</p>
<div class="lisp">
<pre class="lisp">Function: frame-edges &amp;optional frame type ¶
</pre></div>
<p>此函数返回帧的外部、原生或内部帧的绝对边缘。frame 必须是实时帧，默认为选定的帧。返回的列表具有形式（左上右下），其中所有值都以相对于帧显示原点的像素为单位。对于终端帧，left 和 top 返回的值始终为零。
</p>
<p>可选参数 type 指定要返回的边的类型：outer-edges 表示返回帧的外边，native-edges（或 nil）表示返回其原生边，inner-edges 表示返回其内边。
</p>
<p>按照惯例，左侧和顶部返回值处的显示像素被认为是在帧内（部分）。因此，如果 left 和 top 都为零，则显示原点的像素是帧的一部分。另一方面，底部和右侧的像素被认为位于帧外。这意味着，例如，如果您有两个并排的帧，使左侧帧的右外边缘等于右侧帧的左外边缘，则该边缘的像素显示一部分右边的帧。
</p>
<hr/>

<div class="nav-panel"><p>Next: <a href="30.3.2_帧字体.html">帧字体</a>, Previous: <a href="30.3_帧几何.html">帧几何</a>, Up: <a href="30.3_帧几何.html">帧几何.</a> &nbsp; [<a href="00_content.htm" title="Table of contents" rel="contents">Contents</a>]</p></div></body></html>